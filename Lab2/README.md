## Telegram-бот компании «ТралалелоТралала»

Краткий и дружелюбный бот на Python (python-telegram-bot v21), который:

- Отвечает на вопросы о компании/проекте/команде
- Показывает контакты коллег
- Напоминает о важных событиях (еженедельно)
- Отправляет ежедневные дайджесты подписчикам
- Читает сотрудников из CSV/Excel и ищет по отделу/должности/имени

### Быстрый старт

1) Установите Python 3.10+

2) Клонируйте проект и перейдите в папку

3) Установите зависимости:

```bash
pip install -r requirements.txt
```

4) Установите переменные окружения. Создайте файл `.env` рядом с `bot.py` со следующим содержимым:

```bash
BOT_TOKEN=ваш_токен_бота
TIMEZONE=Europe/Moscow
```

Примечание: если в редакторе недоступно создание скрытого файла `.env.example`, используйте этот блок для примера.

5) Запустите бота:

```bash
python bot.py
```

Бот начнёт опрос обновлений и будет готов к работе.

### Команды бота

- `/start` — приветствие и подписка на ежедневные дайджесты
- `/help` — список команд
- `/company` — информация о компании
- `/team` — состав команды
- `/contacts` — контакты сотрудников
- `/events` — предстоящие события (еженедельные)
- `/digest` — дайджест на сегодня
 - `/departments` — список отделов из файла сотрудников
 - `/staff [отдел]` — сотрудники (опционально фильтр по отделу)
 - `/find <строка>` — поиск по частичному совпадению в имени/должности/отделе

### Данные и хранилище

- Все данные хранятся в `data.json`:
  - company (название, сфера)
  - team (участники и роли)
  - contacts (актуальные контакты)
  - events (день недели, время, описание)
  - digests (сообщения на каждый день недели)
  - subscribers (список chat_id подписчиков, пополняется через `/start`)

Редактируйте `data.json` для обновления информации — бот подхватывает изменения при каждом запросе/рассылке.

### Данные сотрудников (CSV/Excel)

- Формат колонок: `name, department, position, email, phone, hire_date`.
- Разместите файл `employees.csv` или `employees.xlsx` рядом с `bot.py`.
- Примеры команд:
  - `/departments`
  - `/staff Продажи`
  - `/find маркет`

Обработка ошибок: при отсутствии файла/колонок бот ответит коротким сообщением и запишет подробности в логи.

### Рассылка и напоминания

- Ежедневный дайджест отправляется в 09:00 (локальная зона из `TIMEZONE`).
- Напоминания о событиях отправляются еженедельно за 15 минут до времени события.
- Подписка/отписка: при `/start` текущий чат добавляется в `subscribers`. Удалить подписку можно вручную, удалив chat_id из `subscribers` в `data.json` (минимально достаточная реализация).

### Обработка ошибок

- Ошибки логируются в консоль (logging INFO/ERROR).
- Пользователь получает короткое дружелюбное сообщение при сбое обработки команды.

### Требования

- Python 3.10+
- Зависимости из `requirements.txt`
  - Включая `pandas` и `openpyxl` для CSV/Excel

### Примечания по разработке

- Бот использует `python-telegram-bot` v21 (асинхронный API) и `JobQueue` для расписаний.
- Таймзона настраивается через `TIMEZONE` (по умолчанию Europe/Moscow).
- Код структурирован и снабжён комментариями, данные — в JSON.


